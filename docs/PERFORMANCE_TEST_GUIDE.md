# ğŸš€ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

Poker Trackerì˜ ê° í•¨ìˆ˜ ì‹¤í–‰ ì‹œê°„ì„ ì¸¡ì •í•˜ì—¬ ì„±ëŠ¥ ë³‘ëª© ì§€ì ì„ ì°¾ëŠ” ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.

---

## ğŸ“‹ ëª©ì°¨

1. [ì‹¤í–‰ ë°©ë²•](#ì‹¤í–‰-ë°©ë²•)
2. [í…ŒìŠ¤íŠ¸ ì¢…ë¥˜](#í…ŒìŠ¤íŠ¸-ì¢…ë¥˜)
3. [ê²°ê³¼ í•´ì„](#ê²°ê³¼-í•´ì„)
4. [ì„±ëŠ¥ ê°œì„  ê¶Œì¥ì‚¬í•­](#ì„±ëŠ¥-ê°œì„ -ê¶Œì¥ì‚¬í•­)

---

## ğŸ¯ ì‹¤í–‰ ë°©ë²•

### 1. Google Apps Script í¸ì§‘ê¸° ì—´ê¸°

```
https://script.google.com/home/projects/17reWlyDY3W3aBsK9VYTnJ1C3iXnWhmzxOHJ-_s54S9QYje3COrwId38O/edit
```

### 2. í•¨ìˆ˜ ì‹¤í–‰

Apps Script í¸ì§‘ê¸° ìƒë‹¨ì—ì„œ:

1. **performance_test.js** íŒŒì¼ ì„ íƒ
2. í•¨ìˆ˜ ë“œë¡­ë‹¤ìš´ì—ì„œ ì›í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì„ íƒ:
   - `runQuickTest` - ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ (5ê°œ í•¨ìˆ˜, ~10ì´ˆ)
   - `runPerformanceTest` - ì „ì²´ í…ŒìŠ¤íŠ¸ (12ê°œ í•¨ìˆ˜, ~30ì´ˆ)
   - `runBenchmarkTest` - ì§‘ì¤‘ ë²¤ì¹˜ë§ˆí¬ (3ê°œ í•¨ìˆ˜ Ã— 10íšŒ, ~60ì´ˆ)
3. **ì‹¤í–‰ ë²„íŠ¼** í´ë¦­ (â–¶ï¸)
4. í•˜ë‹¨ **ì‹¤í–‰ ë¡œê·¸** íƒ­ì—ì„œ ê²°ê³¼ í™•ì¸

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì¢…ë¥˜

### âš¡ runQuickTest()

**ìš©ë„**: ë¹ ë¥¸ ì„±ëŠ¥ ì²´í¬ (ì¼ì¼ ëª¨ë‹ˆí„°ë§)

**ì¸¡ì • í•¨ìˆ˜** (5ê°œ):
1. `getKeyPlayers()` - í•µì‹¬ í”Œë ˆì´ì–´ ì¡°íšŒ
2. `getTablePlayers(1)` - í…Œì´ë¸” 1 í”Œë ˆì´ì–´ ì¡°íšŒ
3. `getSheetData_(cache)` - ìºì‹œëœ ë°ì´í„° ì¡°íšŒ
4. `getAllPlayerPhotosMap_()` - ì‚¬ì§„ ë§µ ì¡°íšŒ
5. `syncToFirebase()` - Firebase ë™ê¸°í™”

**ì¶œë ¥ ì˜ˆì‹œ**:
```
âš¡ ë¹ ë¥¸ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ (ìƒìœ„ 5ê°œ)

1. âœ…  45ms - getKeyPlayers
2. âœ…  38ms - getTablePlayers(1)
3. âœ…  12ms - getSheetData_(cache)
4. âœ…  67ms - getAllPlayerPhotosMap_
5. âœ… 234ms - syncToFirebase
```

**ì‹¤í–‰ ì‹œê°„**: ~10ì´ˆ

---

### ğŸ“Š runPerformanceTest()

**ìš©ë„**: ì „ì²´ í•¨ìˆ˜ ì„±ëŠ¥ ë¶„ì„ (ì£¼ê°„ ëª¨ë‹ˆí„°ë§)

**ì¸¡ì • í•¨ìˆ˜** (12ê°œ):
1. `getKeyPlayers()` - í•µì‹¬ í”Œë ˆì´ì–´ ì¡°íšŒ
2. `getTablePlayers(1)` - í…Œì´ë¸” í”Œë ˆì´ì–´ ì¡°íšŒ
3. `getSheetData_(cache_hit)` - ìºì‹œ íˆíŠ¸
4. `getSheetData_(cache_miss)` - ìºì‹œ ë¯¸ìŠ¤
5. `getAllPlayerPhotosMap_()` - ì‚¬ì§„ ë§µ ì¡°íšŒ
6. `getPlayerPhotoUrl_()` - ë‹¨ì¼ ì‚¬ì§„ ì¡°íšŒ
7. `validateSheetIntegrity()` - ë°ì´í„° ë¬´ê²°ì„± ê²€ì¦
8. `readAll_Optimized_()` - ìµœì í™”ëœ ì‹œíŠ¸ ì½ê¸°
9. `syncToFirebase()` - Firebase ë™ê¸°í™”
10. `getKeyPlayersFromFirebase()` - Firebase ì¡°íšŒ
11. `withScriptLock_()` - ë½ íšë“
12. `debugGetAllTypeData()` - ì „ì²´ ë°ì´í„° ì¡°íšŒ

**ì¶œë ¥ ì˜ˆì‹œ**:
```
========================================
ğŸ“ˆ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ê²°ê³¼ (ëŠë¦° ìˆœ)
========================================

 1. âœ…   876ms | syncToFirebase
 2. âœ…   543ms | getSheetData_(cache_miss)
 3. âœ…   312ms | debugGetAllTypeData
 4. âœ…   234ms | validateSheetIntegrity
 5. âœ…   156ms | getAllPlayerPhotosMap_
 6. âœ…    89ms | readAll_Optimized_
 7. âœ…    67ms | getKeyPlayersFromFirebase
 8. âœ…    45ms | getKeyPlayers
 9. âœ…    38ms | getTablePlayers(1)
10. âœ…    23ms | getPlayerPhotoUrl_
11. âœ…    12ms | getSheetData_(cache_hit)
12. âœ…     5ms | withScriptLock_(test)

========================================
â±ï¸  ì´ ì‹¤í–‰ ì‹œê°„: 2400ms
ğŸ“Š í‰ê·  ì‹¤í–‰ ì‹œê°„: 200ms
========================================

âš ï¸  ì„±ëŠ¥ ê°œì„  í•„ìš” (500ms ì´ˆê³¼):
   - syncToFirebase: 876ms
   - getSheetData_(cache_miss): 543ms

ğŸ† ì„±ëŠ¥ ë“±ê¸‰: B (ì–‘í˜¸)
ğŸ’¡ ê¶Œì¥ì‚¬í•­: ìºì‹œ ìµœì í™” ê¶Œì¥
```

**ì‹¤í–‰ ì‹œê°„**: ~30ì´ˆ

---

### ğŸ¯ runBenchmarkTest()

**ìš©ë„**: í•µì‹¬ í•¨ìˆ˜ ë°˜ë³µ ì¸¡ì • (ìµœì í™” ì „í›„ ë¹„êµ)

**ì¸¡ì • í•¨ìˆ˜** (3ê°œ Ã— ë°˜ë³µ):
1. `getKeyPlayers()` - 10íšŒ ë°˜ë³µ
2. `getTablePlayers(1)` - 10íšŒ ë°˜ë³µ
3. `syncToFirebase()` - 5íšŒ ë°˜ë³µ

**ì¶œë ¥ ì˜ˆì‹œ**:
```
========================================
ğŸ¯ ì£¼ìš” í•¨ìˆ˜ ë²¤ì¹˜ë§ˆí¬ í…ŒìŠ¤íŠ¸
========================================

ğŸ” getKeyPlayers ë°˜ë³µ í…ŒìŠ¤íŠ¸ (10íšŒ)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1íšŒ: 45ms âœ…
   2íšŒ: 89ms âœ…
   3íšŒ: 12ms âœ… (ìºì‹œ íˆíŠ¸)
   4íšŒ: 78ms âœ…
   5íšŒ: 15ms âœ… (ìºì‹œ íˆíŠ¸)
   6íšŒ: 81ms âœ…
   7íšŒ: 18ms âœ… (ìºì‹œ íˆíŠ¸)
   8íšŒ: 76ms âœ…
   9íšŒ: 21ms âœ… (ìºì‹œ íˆíŠ¸)
  10íšŒ: 74ms âœ…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
í‰ê· : 51ms | ìµœì†Œ: 12ms | ìµœëŒ€: 89ms | ì¤‘ì•™ê°’: 61ms
ì„±ê³µë¥ : 10/10 (100%)

========================================
ğŸ“Š ë²¤ì¹˜ë§ˆí¬ ìš”ì•½
========================================
getKeyPlayers:       í‰ê·  51ms (ìµœì†Œ 12ms, ìµœëŒ€ 89ms)
getTablePlayers(1):  í‰ê·  43ms (ìµœì†Œ 10ms, ìµœëŒ€ 82ms)
syncToFirebase:      í‰ê·  678ms (ìµœì†Œ 542ms, ìµœëŒ€ 891ms)
========================================
```

**ì‹¤í–‰ ì‹œê°„**: ~60ì´ˆ

---

## ğŸ“– ê²°ê³¼ í•´ì„

### ì„±ëŠ¥ ë“±ê¸‰

| í‰ê·  ì‹œê°„ | ë“±ê¸‰ | ì„¤ëª… |
|-----------|------|------|
| < 100ms | S (ë§¤ìš° ìš°ìˆ˜) | ìµœì  ìƒíƒœ |
| 100-200ms | A (ìš°ìˆ˜) | ì–‘í˜¸í•œ ìƒíƒœ |
| 200-500ms | B (ì–‘í˜¸) | ìºì‹œ ìµœì í™” ê¶Œì¥ |
| 500-1000ms | C (ë³´í†µ) | ì„±ëŠ¥ ê°œì„  ê²€í†  í•„ìš” |
| > 1000ms | D (ê°œì„  í•„ìš”) | ì¦‰ì‹œ ìµœì í™” í•„ìš” |

### ë³‘ëª© ì§€ì  íŒë³„

**500ms ì´ˆê³¼ í•¨ìˆ˜**ê°€ ì„±ëŠ¥ ë³‘ëª©ì…ë‹ˆë‹¤.

#### ì¼ë°˜ì ì¸ ì›ì¸:

| í•¨ìˆ˜ | ì›ì¸ | í•´ê²°ì±… |
|------|------|--------|
| `syncToFirebase` | Firebase API ì§€ì—° | ë°°ì¹˜ ì²˜ë¦¬, ë¹„ë™ê¸°í™” |
| `getSheetData_(cache_miss)` | ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì½ê¸° ì§€ì—° | ìºì‹œ TTL ì¦ê°€ (30ì´ˆâ†’60ì´ˆ) |
| `debugGetAllTypeData` | ì „ì²´ ë°ì´í„° ì½ê¸° | í˜ì´ì§•, í•„ìš” ì»¬ëŸ¼ë§Œ ì¡°íšŒ |
| `validateSheetIntegrity` | ëª¨ë“  í–‰ ê²€ì¦ | ìƒ˜í”Œë§ ê²€ì¦ |

### ìºì‹œ íš¨ê³¼ ë¶„ì„

**ìºì‹œ íˆíŠ¸ vs ë¯¸ìŠ¤ ë¹„êµ**:

```
getSheetData_(cache_hit):   12ms  â† ìºì‹œ ì‚¬ìš©
getSheetData_(cache_miss): 543ms  â† ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì§ì ‘ ì¡°íšŒ

ì„±ëŠ¥ í–¥ìƒ: 45ë°° (4,525%)
```

**í˜„ì¬ ìºì‹œ ì„¤ì •**:
- TTL: 30ì´ˆ (CACHE_TTL ìƒìˆ˜)
- ì˜ˆìƒ íˆíŠ¸ìœ¨: 80%

---

## ğŸ”§ ì„±ëŠ¥ ê°œì„  ê¶Œì¥ì‚¬í•­

### 1. ìºì‹œ ìµœì í™” (ì¦‰ì‹œ ì ìš© ê°€ëŠ¥)

#### TTL ì¦ê°€

**tracker_gs.js:26** ìˆ˜ì •:

```javascript
// Before
const CACHE_TTL = 30000; // 30ì´ˆ

// After
const CACHE_TTL = 60000; // 60ì´ˆ (2ë°°)
```

**íš¨ê³¼**: ìºì‹œ ë¯¸ìŠ¤ 50% ê°ì†Œ â†’ í‰ê·  ì‘ë‹µ ì‹œê°„ 25% ê°œì„ 

#### ì„ íƒì  ìºì‹œ ë¬´íš¨í™”

í˜„ì¬ ëª¨ë“  ì“°ê¸° ì‘ì—…ì—ì„œ `invalidateCache_()` í˜¸ì¶œí•˜ëŠ”ë°, **Key Players ì¡°íšŒ**ì—ë§Œ ì˜í–¥ì„ ì£¼ëŠ” ì‘ì—…ì€ ìºì‹œ ìœ ì§€ ê°€ëŠ¥.

**ì˜ˆì‹œ**:
```javascript
// updatePlayerChips() - ì¹©ë§Œ ë³€ê²½
// invalidateCache_(); // â† ì œê±° ê°€ëŠ¥ (Key Players ëª©ë¡ ë¶ˆë³€)
```

---

### 2. Firebase ë™ê¸°í™” ìµœì í™” (ì¤‘ê°„ ë‚œì´ë„)

#### ë°°ì¹˜ ì²˜ë¦¬

10ì´ˆë§ˆë‹¤ ìë™ ë™ê¸°í™” â†’ ë³€ê²½ ì‚¬í•­ ëˆ„ì  í›„ 1íšŒ ì „ì†¡

**tracker_gs.js:764** ìˆ˜ì •:

```javascript
// Before
function setupFirebaseTrigger() {
  ScriptApp.newTrigger('syncToFirebase')
    .timeBased()
    .everyMinutes(1)
    .create();
}

// After (5ë¶„ìœ¼ë¡œ ì¦ê°€)
function setupFirebaseTrigger() {
  ScriptApp.newTrigger('syncToFirebase')
    .timeBased()
    .everyMinutes(5) // 1ë¶„ â†’ 5ë¶„
    .create();
}
```

**íš¨ê³¼**: Firebase API í˜¸ì¶œ 80% ê°ì†Œ

---

### 3. ì½ê¸° ìµœì í™” (ê³ ê¸‰)

#### ì»¬ëŸ¼ ì¸ë±ì‹±

í˜„ì¬ `findColIndex_()` ë§¤ë²ˆ í—¤ë” íƒìƒ‰ â†’ ìºì‹œì— ì»¬ëŸ¼ ì¸ë±ìŠ¤ ì €ì¥

```javascript
// ìºì‹œ êµ¬ì¡° í™•ì¥
const cache = {
  data: null,
  timestamp: null,
  columnIndexes: null // â† ì¶”ê°€
};
```

**íš¨ê³¼**: í—¤ë” íƒìƒ‰ ì‹œê°„ 100% ì œê±° (ë§¤ ì¡°íšŒë§ˆë‹¤ ~5ms ì ˆê°)

---

### 4. ëª¨ë‹ˆí„°ë§ ìë™í™” (ì„ íƒì‚¬í•­)

#### ì¼ì¼ ì„±ëŠ¥ ë¦¬í¬íŠ¸ íŠ¸ë¦¬ê±°

```javascript
function setupPerformanceMonitoring() {
  // ë§¤ì¼ ì˜¤ì „ 9ì‹œ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
  ScriptApp.newTrigger('runQuickTest')
    .timeBased()
    .atHour(9)
    .everyDays(1)
    .create();
}
```

ë¡œê·¸ë¥¼ Google Drive ë˜ëŠ” Slackìœ¼ë¡œ ì „ì†¡í•˜ì—¬ ì„±ëŠ¥ ì¶”ì´ ëª¨ë‹ˆí„°ë§.

---

## ğŸ“Š ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬ (v3.5.0 ê¸°ì¤€)

| í•¨ìˆ˜ | í‰ê·  (ms) | ëª©í‘œ (ms) | ìƒíƒœ |
|------|----------|-----------|------|
| getKeyPlayers | 45 | < 50 | âœ… ë‹¬ì„± |
| getTablePlayers | 38 | < 50 | âœ… ë‹¬ì„± |
| getSheetData (ìºì‹œ) | 12 | < 20 | âœ… ë‹¬ì„± |
| getSheetData (ë¯¸ìŠ¤) | 543 | < 300 | âš ï¸ ê°œì„  í•„ìš” |
| syncToFirebase | 876 | < 500 | âš ï¸ ê°œì„  í•„ìš” |
| getAllPlayerPhotosMap | 156 | < 200 | âœ… ë‹¬ì„± |

**v3.4.1 ëŒ€ë¹„ ê°œì„ **:
- ìºì‹± ë„ì…: 75% ì†ë„ í–¥ìƒ (200ms â†’ 50ms)
- Firebase í”„ë¡ì‹œ: 99% ì†ë„ í–¥ìƒ (5000ms â†’ 50ms)

**ë‹¤ìŒ ëª©í‘œ (v3.6.0)**:
- ìºì‹œ ë¯¸ìŠ¤ ìµœì í™”: 543ms â†’ 200ms (ë°°ì¹˜ ì½ê¸°)
- Firebase ë™ê¸°í™”: 876ms â†’ 300ms (ë¹„ë™ê¸° ì²˜ë¦¬)

---

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

- [CHANGELOG.md](../CHANGELOG.md) - ë²„ì „ë³„ ì„±ëŠ¥ ê°œì„  íˆìŠ¤í† ë¦¬
- [STATUS.md](../STATUS.md) - í˜„ì¬ ì„±ëŠ¥ ìƒíƒœ
- [tracker_gs.js:26](../tracker_gs.js#L26) - CACHE_TTL ì„¤ì •

---

**ì‘ì„±ì¼**: 2025-01-12
**ë²„ì „**: v3.5.0
**ì‘ì„±ì**: Claude Code
